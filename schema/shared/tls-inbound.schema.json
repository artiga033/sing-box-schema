{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "https://artiga033.github.io/sing-box-schema/shared/tls-inbound.schema.json",
	"type": "object",
	"properties": {
		"enabled": {
			"type": "boolean",
			"description": "Enable TLS."
		},
		"server_name": {
			"type": "string",
			"description": "Used to verify the hostname on the returned certificates unless insecure is given.\n\nIt is also included in the client's handshake to support virtual hosting unless it is an IP address."
		},
		"alpn": {
			"$ref": "../types/string-or-array.schema.json",
			"description": "List of supported application level protocols, in order of preference."
		},
		"min_version": {
			"type": "string",
			"enum": ["1.0", "1.1", "1.2", "1.3"],
			"description": "The minimum TLS version that is acceptable.\n\nBy default, TLS 1.0 is used when acting as a server."
		},
		"max_version": {
			"type": "string",
			"enum": ["1.0", "1.1", "1.2", "1.3"],
			"description": "The maximum TLS version that is acceptable.\n\nBy default, the maximum version is currently TLS 1.3."
		},
		"cipher_suites": {
			"type": "array",
			"items": {
				"type": "string",
				"enum": [
					"TLS_RSA_WITH_AES_128_CBC_SHA",
					"TLS_RSA_WITH_AES_256_CBC_SHA",
					"TLS_RSA_WITH_AES_128_GCM_SHA256",
					"TLS_RSA_WITH_AES_256_GCM_SHA384",
					"TLS_AES_128_GCM_SHA256",
					"TLS_AES_256_GCM_SHA384",
					"TLS_CHACHA20_POLY1305_SHA256",
					"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA",
					"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA",
					"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
					"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA",
					"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256",
					"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384",
					"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
					"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384",
					"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256",
					"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"
				]
			},
			"description": "A list of enabled TLS 1.0â€“1.2 cipher suites. The order of the list is ignored. Note that TLS 1.3 cipher suites are not configurable."
		},
		"certificate": {
			"$ref": "../types/string-or-array.schema.json",
			"description": "The server certificate line array, in PEM format."
		},
		"certificate_path": {
			"type": "string",
			"description": "The path to the server certificate, in PEM format.\n\nWill be automatically reloaded if file modified."
		},
		"key": {
			"$ref": "../types/string-or-array.schema.json",
			"description": "The server private key line array, in PEM format."
		},
		"key_path": {
			"type": "string",
			"description": "The path to the server private key, in PEM format.\n\nWill be automatically reloaded if file modified."
		},
		"acme": {
			"type": "object",
			"properties": {
				"domain": {
					"$ref": "../types/string-or-array.schema.json",
					"description": "List of domain.\n\nACME will be disabled if empty."
				},
				"data_directory": {
					"type": "string",
					"description": "The directory to store ACME data.\n\n`$XDG_DATA_HOME/certmagic|$HOME/.local/share/certmagic` will be used if empty."
				},
				"default_server_name": {
					"type": "string",
					"description": "Server name to use when choosing a certificate if the ClientHello's ServerName field is empty."
				},
				"email": {
					"type": "string",
					"description": "The email address to use when creating or selecting an existing ACME server account."
				},
				"provider": {
					"type": "string",
					"description": "The ACME CA provider to use.\n\n- `letsencrypt` (default): Let's Encrypt\n- `zerossl`: ZeroSSL\n- `https://...`: Custom"
				},
				"disable_http_challenge": {
					"type": "boolean",
					"description": "Disable all HTTP challenges."
				},
				"disable_tls_alpn_challenge": {
					"type": "boolean",
					"description": "Disable all TLS-ALPN challenges."
				},
				"alternative_http_port": {
					"type": "integer",
					"description": "The alternate port to use for the ACME HTTP challenge."
				},
				"alternative_tls_port": {
					"type": "integer",
					"description": "The alternate port to use for the ACME TLS-ALPN challenge."
				},
				"external_account": {
					"type": "object",
					"properties": {
						"key_id": {
							"type": "string",
							"description": "The key identifier."
						},
						"mac_key": {
							"type": "string",
							"description": "The MAC key."
						}
					},
					"description": "EAB (External Account Binding) contains information necessary to bind or map an ACME account to some other account known by the CA."
				},
				"dns01_challenge": {
					"$ref": "./dns01_challenge.schema.json"
				}
			}
		},
		"ech": {
			"type": "object",
			"properties": {
				"enabled": {
					"type": "boolean",
					"description": "Enable ECH."
				},
				"key": {
					"$ref": "../types/string-or-array.schema.json",
					"description": "ECH key line array, in PEM format."
				},
				"key_path": {
					"type": "string",
					"description": "The path to ECH key, in PEM format.\n\nWill be automatically reloaded if file modified."
				},
				"pq_signature_schemes_enabled": {
					"type": "boolean",
					"deprecated": true,
					"description": "Deprecated in sing-box 1.12.0."
				},
				"dynamic_record_sizing_disabled": {
					"type": "boolean",
					"deprecated": true,
					"description": "Deprecated in sing-box 1.12.0."
				}
			}
		},
		"reality": {
			"type": "object",
			"properties": {
				"enabled": {
					"type": "boolean",
					"description": "Enable REALITY."
				},
				"handshake": {
					"type": "object",
					"allOf": [
						{
							"properties": {
								"server": {
									"type": "string",
									"description": "Handshake server address."
								},
								"server_port": {
									"type": "integer",
									"description": "Handshake server port."
								}
							},
							"required": ["server", "server_port"]
						},
						{
							"$ref": "./dial.schema.json"
						}
					],
					"description": "Handshake server address and Dial Fields."
				},
				"private_key": {
					"type": "string",
					"description": "Private key, generated by `sing-box generate reality-keypair`."
				},
				"short_id": {
					"type": "array",
					"items": {
						"type": "string"
					},
					"description": "A hexadecimal string with zero to eight digits."
				},
				"max_time_difference": {
					"type": "string",
					"description": "The maximum time difference between the server and the client.\n\nCheck disabled if empty."
				}
			}
		}
	}
}
